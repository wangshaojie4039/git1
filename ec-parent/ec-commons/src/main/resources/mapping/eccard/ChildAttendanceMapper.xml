<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.imexue.ec.common.mapper.eccard.ChildAttendanceMapper" >
	
	<select id="getSchoolAttendance" resultType="ChildAttendanceDto">
	  
	  select id,school_id,class_id,child_id,child_name,attendance_date,in_status
	  ,in_time,in_leave_type in_reason_type,in_leave_reason in_reason,out_status,out_time
	  ,out_leave_type out_reason_type,out_leave_reason out_reason
	  from t_child_attendance_${schoolId}
	  where attendance_date = #{date}
	  <if test="classId != null">
	  and class_id = #{classId}
	  </if>
	  <!-- <if test="normal != null">
	  <if test="normal">
	  and in_status = 1 and out_status = 1
	  </if>
	  <if test="!normal">
	  and (in_status != 1 or out_status != 1)
	  </if>
	  </if> -->
	</select>
	
	<delete id="removeAttendance">
	delete from t_child_attendance_${schoolId}
	where child_id = #{childId}
	</delete>
	
	<update id="updateAttendanceClass">
	update t_child_attendance_${schoolId} 
	set class_id = #{classId}
	where child_id = #{childId}
	</update>
	
	<delete id="removeAttendanceByClass">
	delete from t_child_attendance_${schoolId}
	where class_id = #{classId}
	</delete>
	
</mapper>